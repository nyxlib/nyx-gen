#!/bin/bash

########################################################################################################################

THIS_SCRIPT=${BASH_SOURCE[0]:-$0}

while [[ -n $(readlink "${THIS_SCRIPT}") ]]
do
  THIS_SCRIPT=$(readlink "${THIS_SCRIPT}")
done

NYX_GEN_HOME=$(cd "$(dirname "${THIS_SCRIPT}")" && pwd)

########################################################################################################################

NYX_GEN_HOST=$(rustc -Vv | grep '^host:' | cut -f 2 -d ' ')

########################################################################################################################

(
cd ${NYX_GEN_HOME}/bin/

rm -fr "${NYX_GEN_HOME}/build/"

pyinstaller \
--onefile \
--noconfirm \
--specpath "${NYX_GEN_HOME}/build/" \
--workpath "${NYX_GEN_HOME}/bin/" \
--distpath "${NYX_GEN_HOME}/build/" \
--name "nyx-gen-${NYX_GEN_HOST}" \
nyx-gen
)

########################################################################################################################

exit 0

########################################################################################################################
